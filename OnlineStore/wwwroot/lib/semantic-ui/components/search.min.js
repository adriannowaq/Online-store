/*!
 * # Semantic UI 2.4.1 - Search
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
(function(n,t,i,r){"use strict";t=typeof t!="undefined"&&t.Math==Math?t:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();n.fn.search=function(u){var o=n(this),h=o.selector||"",s=(new Date).getTime(),e=[],c=arguments[0],l=typeof c=="string",a=[].slice.call(arguments,1),f;return n(this).each(function(){var y=n.isPlainObject(u)?n.extend(!0,{},n.fn.search.settings,u):n.extend({},n.fn.search.settings),b=y.className,d=y.metadata,ct=y.regExp,g=y.fields,w=y.selector,rt=y.error,lt=y.namespace,nt="."+lt,ft=lt+"-module",p=n(this),tt=p.find(w.prompt),et=p.find(w.searchButton),k=p.find(w.results),ot=p.find(w.result),at=p.find(w.category),it=this,ut=p.data(ft),st=!1,ht=!1,v;v={initialize:function(){v.verbose("Initializing module");v.get.settings();v.determine.searchFields();v.bind.events();v.set.type();v.create.results();v.instantiate()},instantiate:function(){v.verbose("Storing instance of module",v);ut=v;p.data(ft,v)},destroy:function(){v.verbose("Destroying instance");p.off(nt).removeData(ft)},refresh:function(){v.debug("Refreshing selector cache");tt=p.find(w.prompt);et=p.find(w.searchButton);at=p.find(w.category);k=p.find(w.results);ot=p.find(w.result)},refreshResults:function(){k=p.find(w.results);ot=p.find(w.result)},bind:{events:function(){if(v.verbose("Binding events to search"),y.automatic){p.on(v.get.inputEvent()+nt,w.prompt,v.event.input);tt.attr("autocomplete","off")}p.on("focus"+nt,w.prompt,v.event.focus).on("blur"+nt,w.prompt,v.event.blur).on("keydown"+nt,w.prompt,v.handleKeyboard).on("click"+nt,w.searchButton,v.query).on("mousedown"+nt,w.results,v.event.result.mousedown).on("mouseup"+nt,w.results,v.event.result.mouseup).on("click"+nt,w.result,v.event.result.click)}},determine:{searchFields:function(){u&&u.searchFields!==r&&(y.searchFields=u.searchFields)}},event:{input:function(){y.searchDelay?(clearTimeout(v.timer),v.timer=setTimeout(function(){v.is.focused()&&v.query()},y.searchDelay)):v.query()},focus:function(){v.set.focus();y.searchOnFocus&&v.has.minimumCharacters()&&v.query(function(){v.can.show()&&v.showResults()})},blur:function(){var t=i.activeElement===this,n=function(){v.cancel.query();v.remove.focus();v.timer=setTimeout(v.hideResults,y.hideDelay)};if(!t)if(ht=!1,v.resultsClicked){v.debug("Determining if user action caused search to close");p.one("click.close"+nt,w.results,function(t){if(v.is.inMessage(t)||st){tt.focus();return}st=!1;v.is.animating()||v.is.hidden()||n()})}else v.debug("Input blurred without user action, closing results"),n()},result:{mousedown:function(){v.resultsClicked=!0},mouseup:function(){v.resultsClicked=!1},click:function(i){v.debug("Search result selected");var r=n(this),u=r.find(w.title).eq(0),f=r.is("a[href]")?r:r.find("a[href]").eq(0),e=f.attr("href")||!1,h=f.attr("target")||!1,l=u.html(),o=u.length>0?u.text():!1,s=v.get.results(),c=r.data(d.result)||v.get.result(o,s);if(n.isFunction(y.onSelect)&&y.onSelect.call(it,c,s)===!1){v.debug("Custom onSelect callback cancelled default select action");st=!0;return}v.hideResults();o&&v.set.value(o);e&&(v.verbose("Opening search link found in result",f),h=="_blank"||i.ctrlKey?t.open(e):t.location.href=e)}}},handleKeyboard:function(n){var t=p.find(w.result),f=p.find(w.category),o=t.filter("."+b.active),i=t.index(o),s=t.length,h=o.length>0,r=n.which,u={backspace:8,enter:13,escape:27,upArrow:38,downArrow:40},e;if(r==u.escape&&(v.verbose("Escape key pressed, blurring search field"),v.hideResults(),ht=!0),v.is.visible())if(r==u.enter){if(v.verbose("Enter key pressed, selecting active result"),t.filter("."+b.active).length>0)return v.event.result.click.call(t.filter("."+b.active),n),n.preventDefault(),!1}else r==u.upArrow&&h?(v.verbose("Up key pressed, changing active result"),e=i-1<0?i:i-1,f.removeClass(b.active),t.removeClass(b.active).eq(e).addClass(b.active).closest(f).addClass(b.active),n.preventDefault()):r==u.downArrow&&(v.verbose("Down key pressed, changing active result"),e=i+1>=s?i:i+1,f.removeClass(b.active),t.removeClass(b.active).eq(e).addClass(b.active).closest(f).addClass(b.active),n.preventDefault());else if(r==u.enter){v.verbose("Enter key pressed, executing query");v.query();v.set.buttonPressed();tt.one("keyup",v.remove.buttonFocus)}},setup:{api:function(t,i){var r={debug:y.debug,on:!1,cache:y.cache,action:"search",urlData:{query:t},onSuccess:function(n){v.parse.response.call(it,n,t);i()},onFailure:function(){v.displayMessage(rt.serverError);i()},onAbort:function(){},onError:v.error};n.extend(!0,r,y.apiSettings);v.verbose("Setting up API request",r);p.api(r)}},can:{useAPI:function(){return n.fn.api!==r},show:function(){return v.is.focused()&&!v.is.visible()&&!v.is.empty()},transition:function(){return y.transition&&n.fn.transition!==r&&p.transition("is supported")}},is:{animating:function(){return k.hasClass(b.animating)},hidden:function(){return k.hasClass(b.hidden)},inMessage:function(t){if(t.target){var r=n(t.target),u=n.contains(i.documentElement,t.target);return u&&r.closest(w.message).length>0}},empty:function(){return k.html()===""},visible:function(){return k.filter(":visible").length>0},focused:function(){return tt.filter(":focus").length>0}},get:{settings:function(){n.isPlainObject(u)&&u.searchFullText&&(y.fullTextSearch=u.searchFullText,v.error(y.error.oldSearchSyntax,it))},inputEvent:function(){var n=tt[0];return n!==r&&n.oninput!==r?"input":n!==r&&n.onpropertychange!==r?"propertychange":"keyup"},value:function(){return tt.val()},results:function(){return p.data(d.results)},result:function(t,i){var f=["title","id"],u=!1;return t=t!==r?t:v.get.value(),i=i!==r?i:v.get.results(),y.type==="category"?(v.debug("Finding result that matches",t),n.each(i,function(i,r){if(n.isArray(r.results)&&(u=v.search.object(t,r.results,f)[0],u))return!1})):(v.debug("Finding result in results object",t),u=v.search.object(t,i,f)[0]),u||!1}},select:{firstResult:function(){v.verbose("Selecting first result");ot.first().addClass(b.active)}},set:{focus:function(){p.addClass(b.focus)},loading:function(){p.addClass(b.loading)},value:function(n){v.verbose("Setting search input value",n);tt.val(n)},type:function(n){n=n||y.type;y.type=="category"&&p.addClass(y.type)},buttonPressed:function(){et.addClass(b.pressed)}},remove:{loading:function(){p.removeClass(b.loading)},focus:function(){p.removeClass(b.focus)},buttonPressed:function(){et.removeClass(b.pressed)}},query:function(t){t=n.isFunction(t)?t:function(){};var i=v.get.value(),r=v.read.cache(i);t=t||function(){};v.has.minimumCharacters()?(r?(v.debug("Reading result from cache",i),v.save.results(r.results),v.addResults(r.html),v.inject.id(r.results),t()):(v.debug("Querying for",i),n.isPlainObject(y.source)||n.isArray(y.source)?(v.search.local(i),t()):v.can.useAPI()?v.search.remote(i,t):(v.error(rt.source),t())),y.onSearchQuery.call(it,i)):v.hideResults()},search:{local:function(n){var t=v.search.object(n,y.content),i;v.set.loading();v.save.results(t);v.debug("Returned full local search results",t);y.maxResults>0&&(v.debug("Using specified max results",t),t=t.slice(0,y.maxResults));y.type=="category"&&(t=v.create.categoryResults(t));i=v.generateResults({results:t});v.remove.loading();v.addResults(i);v.inject.id(t);v.write.cache(n,{html:i,results:t})},remote:function(t,i){i=n.isFunction(i)?i:function(){};p.api("is loading")&&p.api("abort");v.setup.api(t,i);p.api("query")},object:function(t,i,u){var f=[],e=[],o=[],h=t.toString().replace(ct.escape,"\\$&"),c=new RegExp(ct.beginsWith+h,"i"),s=function(t,i){var r=n.inArray(i,f)==-1,u=n.inArray(i,o)==-1,s=n.inArray(i,e)==-1;r&&u&&s&&t.push(i)};return(i=i||y.source,u=u!==r?u:y.searchFields,n.isArray(u)||(u=[u]),i===r||i===!1)?(v.error(rt.source),[]):(n.each(u,function(r,u){n.each(i,function(n,i){var r=typeof i[u]=="string";r&&(i[u].search(c)!==-1?s(f,i):y.fullTextSearch==="exact"&&v.exactSearch(t,i[u])?s(e,i):y.fullTextSearch==!0&&v.fuzzySearch(t,i[u])&&s(o,i))})}),n.merge(e,o),n.merge(f,e),f)}},exactSearch:function(n,t){return(n=n.toLowerCase(),t=t.toLowerCase(),t.indexOf(n)>-1)?!0:!1},fuzzySearch:function(n,t){var r=t.length,u=n.length,i,f,e;if(typeof n!="string"||(n=n.toLowerCase(),t=t.toLowerCase(),u>r))return!1;if(u===r)return n===t;n:for(i=0,f=0;i<u;i++){for(e=n.charCodeAt(i);f<r;)if(t.charCodeAt(f++)===e)continue n;return!1}return!0},parse:{response:function(n,t){var i=v.generateResults(n);v.verbose("Parsing server response",n);n!==r&&t!==r&&n[g.results]!==r&&(v.addResults(i),v.inject.id(n[g.results]),v.write.cache(t,{html:i,results:n[g.results]}),v.save.results(n[g.results]))}},cancel:{query:function(){v.can.useAPI()&&p.api("abort")}},has:{minimumCharacters:function(){var n=v.get.value(),t=n.length;return t>=y.minCharacters},results:function(){if(k.length===0)return!1;var n=k.html();return n!=""}},clear:{cache:function(n){var t=p.data(d.cache);n?n&&t&&t[n]&&(v.debug("Removing value from cache",n),delete t[n],p.data(d.cache,t)):(v.debug("Clearing cache",n),p.removeData(d.cache))}},read:{cache:function(n){var t=p.data(d.cache);return y.cache?(v.verbose("Checking cache for generated html for query",n),typeof t=="object"&&t[n]!==r?t[n]:!1):!1}},create:{categoryResults:function(t){var i={};return n.each(t,function(n,t){t.category&&(i[t.category]===r?(v.verbose("Creating new category of results",t.category),i[t.category]={name:t.category,results:[t]}):i[t.category].results.push(t))}),i},id:function(n,t){var u=n+1,e=t+1,f,i;return t!==r?(f=String.fromCharCode(97+t),i=f+u,v.verbose("Creating category result id",i)):(i=u,v.verbose("Creating result id",i)),i},results:function(){k.length===0&&(k=n("<div />").addClass(b.results).appendTo(p))}},inject:{result:function(n,t,i){v.verbose("Injecting result into results");var u=i!==r?k.children().eq(i).children(w.results).first().children(w.result).eq(t):k.children(w.result).eq(t);v.verbose("Injecting results metadata",u);u.data(d.result,n)},id:function(t){v.debug("Injecting unique ids into results");var u=0,i=0;return y.type==="category"?n.each(t,function(t,f){i=0;n.each(f.results,function(n){var t=f.results[n];t.id===r&&(t.id=v.create.id(i,u));v.inject.result(t,i,u);i++});u++}):n.each(t,function(n){var u=t[n];u.id===r&&(u.id=v.create.id(i));v.inject.result(u,i);i++}),t}},save:{results:function(n){v.verbose("Saving current search results to metadata",n);p.data(d.results,n)}},write:{cache:function(n,t){var i=p.data(d.cache)!==r?p.data(d.cache):{};y.cache&&(v.verbose("Writing generated html to cache",n,t),i[n]=t,p.data(d.cache,i))}},addResults:function(t){if(n.isFunction(y.onResultsAdd)&&y.onResultsAdd.call(k,t)===!1)return v.debug("onResultsAdd callback cancelled default action"),!1;t?(k.html(t),v.refreshResults(),y.selectFirstResult&&v.select.firstResult(),v.showResults()):v.hideResults(function(){k.empty()})},showResults:function(t){(t=n.isFunction(t)?t:function(){},ht)||!v.is.visible()&&v.has.results()&&(v.can.transition()?(v.debug("Showing results with css animations"),k.transition({animation:y.transition+" in",debug:y.debug,verbose:y.verbose,duration:y.duration,onComplete:function(){t()},queue:!0})):(v.debug("Showing results with javascript"),k.stop().fadeIn(y.duration,y.easing)),y.onResultsOpen.call(k))},hideResults:function(t){t=n.isFunction(t)?t:function(){};v.is.visible()&&(v.can.transition()?(v.debug("Hiding results with css animations"),k.transition({animation:y.transition+" out",debug:y.debug,verbose:y.verbose,duration:y.duration,onComplete:function(){t()},queue:!0})):(v.debug("Hiding results with javascript"),k.stop().fadeOut(y.duration,y.easing)),y.onResultsClose.call(k))},generateResults:function(t){v.debug("Generating html from response",t);var r=y.templates[y.type],u=n.isPlainObject(t[g.results])&&!n.isEmptyObject(t[g.results]),f=n.isArray(t[g.results])&&t[g.results].length>0,i="";return u||f?(y.maxResults>0&&(u?y.type=="standard"&&v.error(rt.maxResults):t[g.results]=t[g.results].slice(0,y.maxResults)),n.isFunction(r)?i=r(t,g):v.error(rt.noTemplate,!1)):y.showNoResults&&(i=v.displayMessage(rt.noResults,"empty")),y.onResults.call(it,t),i},displayMessage:function(n,t){return t=t||"standard",v.debug("Displaying message",n,t),v.addResults(y.templates.message(n,t)),y.templates.message(n,t)},setting:function(t,i){if(n.isPlainObject(t))n.extend(!0,y,t);else if(i!==r)y[t]=i;else return y[t]},internal:function(t,i){if(n.isPlainObject(t))n.extend(!0,v,t);else if(i!==r)v[t]=i;else return v[t]},debug:function(){!y.silent&&y.debug&&(y.performance?v.performance.log(arguments):(v.debug=Function.prototype.bind.call(console.info,console,y.name+":"),v.debug.apply(console,arguments)))},verbose:function(){!y.silent&&y.verbose&&y.debug&&(y.performance?v.performance.log(arguments):(v.verbose=Function.prototype.bind.call(console.info,console,y.name+":"),v.verbose.apply(console,arguments)))},error:function(){y.silent||(v.error=Function.prototype.bind.call(console.error,console,y.name+":"),v.error.apply(console,arguments))},performance:{log:function(n){var t,i,r;y.performance&&(t=(new Date).getTime(),r=s||t,i=t-r,s=t,e.push({Name:n[0],Arguments:[].slice.call(n,1)||"",Element:it,"Execution Time":i}));clearTimeout(v.performance.timer);v.performance.timer=setTimeout(v.performance.display,500)},display:function(){var t=y.name+":",i=0;s=!1;clearTimeout(v.performance.timer);n.each(e,function(n,t){i+=t["Execution Time"]});t+=" "+i+"ms";h&&(t+=" '"+h+"'");o.length>1&&(t+=" ("+o.length+")");(console.group!==r||console.table!==r)&&e.length>0&&(console.groupCollapsed(t),console.table?console.table(e):n.each(e,function(n,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd());e=[]}},invoke:function(t,i,u){var e=ut,h,o,s;return i=i||a,u=it||u,typeof t=="string"&&e!==r&&(t=t.split(/[\. ]/),h=t.length-1,n.each(t,function(i,u){var f=i!=h?u+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(n.isPlainObject(e[f])&&i!=h)e=e[f];else{if(e[f]!==r)return o=e[f],!1;if(n.isPlainObject(e[u])&&i!=h)e=e[u];else return e[u]!==r?(o=e[u],!1):!1}})),n.isFunction(o)?s=o.apply(u,i):o!==r&&(s=o),n.isArray(f)?f.push(s):f!==r?f=[f,s]:s!==r&&(f=s),o}};l?(ut===r&&v.initialize(),v.invoke(c)):(ut!==r&&ut.invoke("destroy"),v.initialize())}),f!==r?f:this};n.fn.search.settings={name:"Search",namespace:"search",silent:!1,debug:!1,verbose:!1,performance:!0,type:"standard",minCharacters:1,selectFirstResult:!1,apiSettings:!1,source:!1,searchOnFocus:!0,searchFields:["title","description"],displayField:"",fullTextSearch:"exact",automatic:!0,hideDelay:0,searchDelay:200,maxResults:7,cache:!0,showNoResults:!0,transition:"scale",duration:200,easing:"easeOutExpo",onSelect:!1,onResultsAdd:!1,onSearchQuery:function(){},onResults:function(){},onResultsOpen:function(){},onResultsClose:function(){},className:{animating:"animating",active:"active",empty:"empty",focus:"focus",hidden:"hidden",loading:"loading",results:"results",pressed:"down"},error:{source:"Cannot search. No source used, and Semantic API module was not included",noResults:"Your search returned no results",logging:"Error in debug logging, exiting.",noEndpoint:"No search endpoint was specified",noTemplate:"A valid template name was not specified.",oldSearchSyntax:"searchFullText setting has been renamed fullTextSearch for consistency, please adjust your settings.",serverError:"There was an issue querying the server.",maxResults:"Results must be an array to use maxResults setting",method:"The method you called is not defined."},metadata:{cache:"cache",results:"results",result:"result"},regExp:{escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,beginsWith:"(?:s|^)"},fields:{categories:"results",categoryName:"name",categoryResults:"results",description:"description",image:"image",price:"price",results:"results",title:"title",url:"url",action:"action",actionText:"text",actionURL:"url"},selector:{prompt:".prompt",searchButton:".search.button",results:".results",message:".results > .message",category:".category",result:".result",title:".title, .name"},templates:{escape:function(n){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=function(n){return t[n]};return/[&<>"'`]/.test(n)?n.replace(/[&<>"'`]/g,i):n},message:function(n,t){var i="";return n!==r&&t!==r&&(i+='<div class="message '+t+'">',i+=t=="empty"?'<div class="header">'+n+'<\/div class="header">':' <div class="description">'+n+"<\/div>",i+="<\/div>"),i},category:function(t,i){var u="",f=n.fn.search.settings.templates.escape;return t[i.categoryResults]!==r?(n.each(t[i.categoryResults],function(t,f){f[i.results]!==r&&f.results.length>0&&(u+='<div class="category">',f[i.categoryName]!==r&&(u+='<div class="name">'+f[i.categoryName]+"<\/div>"),u+='<div class="results">',n.each(f.results,function(n,t){u+=t[i.url]?'<a class="result" href="'+t[i.url]+'">':'<a class="result">';t[i.image]!==r&&(u+='<div class="image"> <img src="'+t[i.image]+'"><\/div>');u+='<div class="content">';t[i.price]!==r&&(u+='<div class="price">'+t[i.price]+"<\/div>");t[i.title]!==r&&(u+='<div class="title">'+t[i.title]+"<\/div>");t[i.description]!==r&&(u+='<div class="description">'+t[i.description]+"<\/div>");u+="<\/div>";u+="<\/a>"}),u+="<\/div>",u+="<\/div>")}),t[i.action]&&(u+='<a href="'+t[i.action][i.actionURL]+'" class="action">'+t[i.action][i.actionText]+"<\/a>"),u):!1},standard:function(t,i){var u="";return t[i.results]!==r?(n.each(t[i.results],function(n,t){u+=t[i.url]?'<a class="result" href="'+t[i.url]+'">':'<a class="result">';t[i.image]!==r&&(u+='<div class="image"> <img src="'+t[i.image]+'"><\/div>');u+='<div class="content">';t[i.price]!==r&&(u+='<div class="price">'+t[i.price]+"<\/div>");t[i.title]!==r&&(u+='<div class="title">'+t[i.title]+"<\/div>");t[i.description]!==r&&(u+='<div class="description">'+t[i.description]+"<\/div>");u+="<\/div>";u+="<\/a>"}),t[i.action]&&(u+='<a href="'+t[i.action][i.actionURL]+'" class="action">'+t[i.action][i.actionText]+"<\/a>"),u):!1}}}})(jQuery,window,document);